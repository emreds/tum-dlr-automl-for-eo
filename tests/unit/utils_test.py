from src.tum_dlr_automl_for_eo.utils import custom_metrics
import numpy as np

dummy_acc_list = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
real_acc_list = [
    88.29126358032227,
    93.23918223381042,
    93.23918223381042,
    92.79847741127014,
    93.23918223381042,
    92.79847741127014,
]

random_acc_list = np.array([
    [17, 74, 77, 81, 61, 84, 10, 82, 56, 66, 44, 40, 72, 23, 6, 59,
     98, 34, 26, 5],
    [15, 67, 3, 47, 8, 82, 36, 81, 29, 37, 37, 95, 67, 6, 44, 4,
     79, 27, 12, 60],
    [30, 57, 47, 29, 23, 92, 93, 90, 55, 95, 59, 38, 1, 93, 55, 97,
     96, 86, 53, 18],
    [52, 57, 78, 86, 47, 39, 66, 59, 69, 83, 24, 95, 66, 15, 20, 10,
     32, 77, 89, 96],
    [41, 21, 28, 84, 81, 33, 85, 0, 14, 87, 98, 74, 95, 79, 20, 56,
     25, 44, 30, 37],
    [53, 87, 57, 26, 10, 74, 59, 12, 88, 82, 16, 77, 35, 19, 9, 91,
     3, 59, 55, 55],
    [37, 39, 13, 83, 81, 1, 79, 97, 10, 56, 21, 33, 13, 79, 30, 48,
     48, 22, 87, 58],
    [74, 75, 63, 16, 65, 56, 87, 76, 48, 66, 27, 17, 24, 0, 71, 4,
     63, 99, 15, 5],
    [43, 15, 44, 97, 86, 12, 16, 14, 67, 11, 21, 37, 75, 80, 31, 12,
     59, 68, 84, 26],
    [50, 31, 28, 3, 49, 66, 1, 19, 91, 51, 61, 54, 2, 80, 23, 78,
     96, 80, 31, 89],
    [25, 11, 29, 96, 7, 63, 88, 61, 74, 57, 83, 34, 53, 34, 34, 39,
     51, 64, 96, 19],
    [74, 87, 90, 59, 10, 85, 30, 27, 45, 80, 15, 31, 29, 24, 19, 81,
     35, 44, 97, 77],
    [41, 28, 15, 89, 77, 40, 63, 3, 37, 12, 99, 41, 43, 86, 98, 5,
     69, 8, 95, 74],
    [49, 99, 26, 3, 77, 86, 66, 79, 67, 15, 26, 76, 70, 97, 0, 42,
     26, 36, 15, 61],
    [29, 56, 69, 53, 17, 97, 23, 35, 99, 51, 81, 59, 2, 80, 76, 81,
     33, 65, 38, 51],
    [91, 45, 63, 17, 66, 16, 40, 41, 10, 25, 57, 16, 35, 74, 77, 63,
     63, 29, 39, 85],
    [80, 81, 61, 14, 3, 49, 50, 95, 75, 82, 66, 86, 26, 33, 76, 54,
     73, 36, 71, 57],
    [41, 50, 61, 25, 74, 34, 77, 53, 37, 30, 46, 64, 41, 63, 59, 88,
     56, 96, 34, 26],
    [24, 38, 29, 66, 2, 85, 56, 23, 74, 14, 31, 75, 20, 90, 68, 22,
     94, 60, 17, 10],
    [68, 74, 69, 31, 54, 3, 52, 6, 32, 84, 52, 91, 3, 6, 20, 9,
     23, 74, 89, 77],
    [12, 24, 37, 33, 27, 78, 75, 19, 73, 44, 1, 87, 74, 95, 95, 96,
     96, 43, 22, 49],
    [72, 59, 68, 19, 93, 68, 7, 1, 56, 92, 21, 66, 48, 48, 70, 86,
     16, 95, 38, 38],
    [21, 25, 41, 58, 49, 2, 20, 23, 9, 59, 18, 29, 18, 43, 77, 28,
     92, 79, 75, 87],
    [33, 82, 7, 75, 96, 66, 79, 64, 25, 55, 75, 86, 16, 6, 94, 9,
     27, 77, 26, 34],
    [14, 13, 96, 38, 56, 35, 18, 45, 50, 19, 42, 66, 80, 98, 86, 91,
     35, 21, 0, 53],
    [2, 63, 41, 25, 69, 56, 80, 49, 9, 88, 9, 52, 0, 21, 83, 65,
     0, 89, 34, 53],
    [23, 36, 89, 28, 70, 24, 9, 35, 41, 30, 15, 56, 2, 50, 59, 63,
     53, 42, 72, 24],
    [53, 73, 37, 48, 41, 93, 7, 26, 80, 69, 51, 83, 22, 69, 23, 31,
     79, 13, 23, 17],
    [56, 24, 72, 59, 23, 42, 37, 62, 12, 80, 94, 97, 70, 51, 38, 91,
     42, 97, 42, 7],
    [97, 63, 34, 49, 75, 63, 11, 32, 78, 8, 5, 10, 77, 58, 21, 12,
     99, 68, 70, 9],
    [5, 20, 3, 39, 57, 8, 89, 79, 53, 64, 72, 12, 7, 88, 18, 42,
     81, 18, 56, 90],
    [21, 17, 67, 80, 46, 46, 75, 29, 16, 42, 14, 45, 98, 22, 34, 39,
     14, 96, 5, 66]])
uniform_acc_list = np.array([
    [43.90893395, 76.20555331, 78.13239366, 58.9386791, 74.54189062,
     72.1909125, 4.05457874, 25.49413298, 37.81329597, 1.82420543,
     33.03778006, 9.20931744, 99.27041863, 21.75620481, 3.59206596,
     88.58196192, 40.71166453, 47.92788967, 5.28942373, 73.71957821],
    [79.72333362, 56.27323323, 88.61171972, 36.87384746, 38.87493986,
     69.94303269, 36.37746988, 96.88339824, 24.91748695, 68.12251018,
     5.24882708, 11.87029177, 11.81249713, 17.5502912, 7.37709557,
     1.02676965, 65.91886022, 91.1947526, 92.94546958, 37.10899283],
    [39.23679205, 7.7198954, 10.16521144, 74.12613508, 70.10735003,
     29.27353294, 53.19406279, 68.48997779, 88.04247921, 7.33430587,
     40.55291137, 53.34668547, 26.84117634, 82.00280869, 40.65225919,
     14.17349657, 86.36462843, 94.19086395, 72.65535919, 80.52462034],
    [98.43672233, 58.96639982, 32.71391126, 29.15276376, 94.52403744,
     98.85368655, 10.04997185, 12.3506786, 3.8757015, 60.5642234,
     28.28270937, 93.46486866, 21.6395748, 83.20918979, 25.83739004,
     39.24709737, 75.98078852, 42.55909401, 82.74139956, 75.78714918],
    [61.25470809, 6.78679831, 74.62230535, 61.74220543, 48.92375914,
     28.57905768, 88.27598994, 45.59341163, 69.4758085, 63.79844907,
     66.13897034, 30.16585206, 56.85038797, 36.76067942, 51.23331687,
     87.27638856, 38.33946219, 98.33103888, 80.97597998, 60.68791535],
    [53.45620439, 19.06905111, 8.36146135, 44.6722663, 64.77179637,
     36.94046138, 95.83115122, 8.57160556, 57.58710966, 20.01693902,
     43.88127821, 94.1414823, 28.27906677, 4.03506373, 6.56637289,
     78.24415589, 47.01581345, 22.50214426, 99.96683897, 16.63809577],
    [96.92844849, 57.23301025, 60.30473148, 84.21729674, 4.07528645,
     94.2033876, 34.90774774, 3.87463374, 74.72266852, 87.80867114,
     7.46762553, 31.92503926, 71.35544179, 18.8906383, 62.61944797,
     50.51195776, 53.39876269, 1.90440266, 89.81408744, 95.6551275],
    [63.18027706, 54.76049944, 46.90002499, 79.76933267, 92.73029572,
     46.77814364, 90.44432142, 14.15185518, 74.20584303, 72.14392569,
     9.89764781, 50.2937134, 55.04704346, 63.9600048, 15.00820674,
     39.67400767, 48.9114509, 55.64554353, 94.51153829, 87.6862466],
    [52.23208396, 21.50602475, 81.26928523, 40.13189625, 39.47248779,
     90.50216552, 57.172293, 71.17635653, 52.3663191, 56.27845561,
     20.31695021, 12.0425108, 73.85394835, 70.26660142, 45.38351566,
     30.65085183, 83.56444325, 47.87733902, 41.76062921, 56.72062971],
    [69.95916238, 16.97554916, 29.68167477, 20.92620554, 58.06073613,
     70.45211006, 48.25271682, 97.39256184, 88.83898971, 15.93469455,
     96.21779712, 0.33413361, 40.49198364, 87.57908082, 74.13863966,
     4.48810223, 13.12328829, 67.39625754, 95.702297, 66.27591776],
    [7.68535022, 75.26099359, 58.62848772, 54.33329903, 42.53532622,
     31.53813638, 85.05551751, 69.67755098, 63.11554956, 84.24283025,
     96.08036366, 78.55865801, 82.19999545, 42.75870186, 43.0916019,
     12.19976469, 94.29272268, 82.82408185, 69.53149048, 73.41552794],
    [79.32931073, 49.24539702, 38.59955447, 15.24872667, 52.34446069,
     62.11586439, 39.4825911, 2.45421984, 98.06061088, 80.26250809,
     68.83497179, 37.63928533, 65.24127244, 16.08098777, 83.98817586,
     22.39319031, 61.94249644, 23.82531018, 84.83192424, 18.61022889],
    [26.8490909, 65.91080494, 36.91398827, 73.23097654, 73.80716394,
     38.31493851, 14.34249569, 20.43522132, 66.5349018, 29.25624505,
     58.44788851, 11.25772263, 15.81360405, 0.39547479, 70.2245369,
     52.49906876, 63.83614953, 68.27442916, 93.038346, 43.5442812],
    [23.77924783, 12.06130174, 54.10195819, 10.74553759, 59.01691013,
     68.0341485, 16.03300595, 43.36522681, 66.03617381, 54.27502783,
     75.08076939, 6.69768661, 96.28489436, 33.9243432, 7.58691095,
     74.96247104, 58.23536799, 26.47033992, 98.41615509, 90.74888165],
    [33.94402055, 48.37672908, 96.85439052, 91.52921854, 48.31256806,
     22.30365187, 31.11597381, 6.31377798, 1.80066267, 60.75855793,
     66.75495841, 62.33092492, 65.96034342, 16.81587247, 12.49681732,
     34.76897079, 60.65832155, 48.69005666, 86.39155885, 69.80192883],
    [13.92657735, 80.13061409, 82.86001381, 92.17293957, 3.23114151,
     38.08500125, 84.86538635, 29.29331093, 39.62654943, 63.72558753,
     86.45126909, 47.34221099, 52.22129015, 94.2536638, 72.14068951,
     98.67327061, 53.65118747, 52.38760303, 50.72331039, 67.23251575],
    [93.14334873, 34.19275252, 55.74462481, 70.88121917, 50.38336996,
     80.5571698, 92.73047425, 40.03298949, 48.59104379, 62.71567198,
     92.61974082, 77.71938565, 13.87147324, 19.4195809, 40.19940355,
     3.32306056, 67.82653242, 45.96438593, 16.16734208, 8.39723918],
    [43.68377699, 80.89115989, 60.59907265, 26.17112477, 40.05599777,
     27.35449806, 89.86187431, 85.85832647, 62.63454525, 40.77479759,
     78.76689006, 55.94429878, 70.46303938, 89.81698315, 6.59650421,
     40.82392328, 60.21213166, 97.83130513, 8.51628531, 14.94044522],
    [21.73874431, 60.03551496, 73.36836922, 75.8648238, 58.80640952,
     90.77804061, 82.8660642, 13.81250774, 83.59531465, 9.49951734,
     14.13577784, 57.7838687, 10.70603284, 93.55659753, 10.10444494,
     86.14922051, 47.8272956, 61.16802686, 61.0283081, 46.76589169],
    [2.25594859, 69.77180118, 10.81316289, 88.79368527, 89.10903059,
     8.13654139, 93.89309268, 55.20988358, 21.19848642, 7.91519697,
     53.7352306, 83.65284337, 72.46697408, 58.03289809, 34.02654732,
     63.83665875, 17.84422623, 10.14187257, 98.72545414, 14.24326038],
    [44.61115641, 64.90575062, 39.20077884, 87.68008001, 36.70171588,
     76.00157925, 60.67574433, 96.42008206, 58.03349941, 3.22989959,
     1.49891933, 15.30441705, 36.66255939, 44.42376024, 83.31082372,
     67.5647036, 90.72507024, 53.47571467, 67.16659186, 61.88458426],
    [25.08638447, 12.17547717, 81.42394099, 49.333325, 37.6208734,
     58.12230009, 1.94634055, 13.70881809, 74.02538994, 0.69020602,
     47.00296368, 33.60204889, 75.20351955, 31.04298197, 52.79730448,
     86.76845853, 28.33126393, 77.29957084, 21.91898174, 45.97143478],
    [9.93077711, 37.59623321, 58.3737159, 41.03928572, 0.14723141,
     1.1062892, 61.66247414, 60.50647053, 72.93004044, 28.25888097,
     94.64605479, 64.80611407, 3.07698381, 17.83033779, 67.11695795,
     8.52296637, 56.83908506, 16.89008753, 36.88300408, 80.98438055],
    [64.43629507, 31.61608636, 64.68665483, 62.11945651, 16.22558598,
     40.35328815, 79.96191601, 34.79083329, 39.55145865, 36.21279125,
     79.193476, 87.21165271, 86.97648361, 4.7316165, 39.27625461,
     10.21328307, 93.25517183, 68.0405307, 72.6597839, 90.60178265],
    [88.89446848, 35.70588838, 1.31787603, 47.35257425, 39.68004695,
     18.60932414, 96.87480347, 45.67350127, 92.77104268, 44.44629035,
     35.12712986, 98.61849525, 85.99768297, 43.45567185, 8.65525557,
     93.07373005, 41.21262694, 7.03498111, 92.70077591, 74.94366087],
    [63.0457862, 88.23744303, 55.91216975, 87.7436298, 85.28338245,
     47.4266058, 29.40759185, 64.02313921, 41.98874105, 9.19625885,
     27.10370941, 97.89424602, 5.03617422, 19.84724937, 56.14105575,
     51.51115957, 99.68998614, 6.95430531, 69.86999059, 45.76561092],
    [61.87728849, 66.1432537, 28.20495095, 29.59440349, 76.95105186,
     87.23079418, 91.21034169, 59.43293848, 30.4379677, 78.55280178,
     14.20770075, 31.40567686, 53.51169512, 15.91892512, 88.8281421,
     79.10246882, 78.61284314, 35.65591247, 19.74438267, 3.32913075],
    [93.94151034, 75.31401619, 49.31056665, 13.77948691, 70.35981948,
     25.69415118, 36.99652239, 65.95995962, 44.27938647, 0.91696243,
     34.00579246, 2.09549044, 58.99790935, 35.21103262, 33.8998538,
     43.53122261, 76.40505176, 12.51472662, 60.53301444, 93.44486496],
    [8.24615771, 89.9363992, 32.12054048, 17.9280258, 18.93146548,
     55.52979834, 15.42654696, 99.57440782, 59.90659226, 0.15052478,
     10.73283368, 46.72807276, 0.63793143, 41.36872597, 78.99643458,
     62.89097723, 21.7172661, 90.11646441, 65.80044664, 36.43044349],
    [62.64325104, 44.38369662, 72.62551929, 69.86971731, 16.26239823,
     51.67800586, 35.70751149, 94.70853663, 89.26037685, 70.14043372,
     1.77923699, 56.36735112, 93.24129536, 91.50608288, 85.17568059,
     27.77087718, 44.11590132, 98.22823049, 93.04022785, 9.64205381],
    [93.46396312, 99.19073862, 72.59852196, 25.81655669, 19.96519768,
     66.3208888, 44.15720137, 65.48651731, 21.87824438, 83.88804116,
     46.81166968, 3.61743326, 20.69677945, 39.80930952, 71.938913,
     10.81635686, 92.99505095, 82.79307716, 26.42380731, 50.4561894],
    [76.37836466, 42.17036179, 77.52831668, 6.75353186, 73.48517008,
     87.69573341, 61.48725816, 80.0068179, 60.52043262, 7.64816553,
     57.90123988, 26.20172226, 87.41242448, 14.66973762, 7.69836356,
     4.03142535, 23.08445631, 94.26343229, 49.41707639, 59.27008547]])


def test_mean_accuracy():
    assert custom_metrics.mean_accuracy(dummy_acc_list) == 5.5
    assert custom_metrics.mean_accuracy(real_acc_list) == 92.26762751738231


def test_variance():
    assert custom_metrics.variance(dummy_acc_list) == 9.166666666666666
    assert custom_metrics.variance(real_acc_list) == 3.8413658161348487


def test_persistence():
    assert custom_metrics.persistence(random_acc_list) == 0.
    assert custom_metrics.persistence(uniform_acc_list) == 1.2562805553149108e-23
